SELECT IEAN AS EAN,
ICOD AS MODELO,
IDESCR AS DESCRIPCION,
ALMCANT AS INVENTARIO,
ILISTA1 AS PRECIO,
FAM1.FAMDESCR AS PROVEEDOR,
FAM1.FAMDESCR AS PROVEEDOR,
CATDESCR AS TIENDA,
IF(CATMULTICIA = 1, ILISTA8,IF(CATMULTICIA=2, ILISTA5,IF (CATMULTICIA=3,ILISTA3, IF (CATMULTICIA=4,ILISTA2,ILISTA2)))) AS COSTO,
IF(CATMULTICIA = 1, ILISTA8*ALMCANT,IF(CATMULTICIA=2, ILISTA5*ALMCANT,IF (CATMULTICIA=3,ILISTA3*ALMCANT, IF (CATMULTICIA=4,ILISTA2*ALMCANT,ILISTA2*ALMCANT))))AS COSTO_TOTAL

from FINV

LEFT JOIN FALM ON FALM.ISEQ = FINV.ISEQ
LEFT JOIN FALMCAT ON  FALMCAT.CATALM = FALM.ALMNUM
LEFT JOIN FFAM AS FAM1 ON FAM1.FAMTNUM=FINV.IFAM1
LEFT JOIN FFAM AS FAM2 ON FAM2.FAMTNUM=FINV.IFAM2
LEFT JOIN FFAM AS FAM3 ON FAM3.FAMTNUM=FINV.IFAM3
LEFT JOIN FFAM AS FAM4 ON FAM4.FAMTNUM=FINV.IFAM4
LEFT JOIN FFAM AS FAM5 ON FAM5.FAMTNUM=FINV.IFAM5
LEFT JOIN FFAM AS FAM6 ON FAM6.FAMTNUM=FINV.IFAM6
LEFT JOIN FFAM AS FAM7 ON FAM7.FAMTNUM=FINV.IFAM7
LEFT JOIN FFAM AS FAM8 ON FAM8.FAMTNUM=FINV.IFAM8
LEFT JOIN FFAM AS FAM9 ON FAM9.FAMTNUM=FINV.IFAM9


where ALMCANT > 0 and ALMNUM > 302 and ALMNUM < 503